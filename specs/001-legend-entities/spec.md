# Feature Specification: 奇点实体管理与分析系统

**Feature Branch**: `001-legend-entities`
**Created**: 2026-02-01
**Status**: Draft
**Input**: 用户描述："现在我要给项目添加第一个功能【奇点】，这是整个项目最核心的功能，用于管理监控分析奇点实体发展情况的功能模块"

## Clarifications

### Session 2026-02-01

- Q: 关注度评分的计算方式 → A: 使用舆情分析工具（如Google Search数量、Twitter粉丝数等）来量化奇点效应，因奇点必然引发舆论风波。如果工具不可用，则使用主观排名作为备用方案。
- Q: 资讯面板的交互模式 → A: 跳转到新页面。正式命名为"Legend资讯中心"（Legend排行榜点击后进入）。Legend排行榜采用左右结构：左侧legend列表，右侧近一周相关新闻。排行榜是应用首页，会随新闻推送实时变化，将24小时内在舆情风口浪尖的legend推到前三位。
- Q: 排行榜实时更新机制与排名算法 → A: MVP阶段使用简化算法：创建新闻统计表，各legend按照新闻数量排名。实时更新采用手动刷新方式，后续可优化为定时自动刷新。
- Q: 新闻数据保留策略 → A: 仅保留新闻标题（不保留正文），保存时间3年。暂不考虑删除/清理功能，后续完善。
- Q: Legend资讯中心的信息架构布局 → A: 采用标签页切换模式，**标签页 = legend的工作方向**。第一个标签是"近期新闻驱动"（动态变化，如今天SpaceX新闻 → 马斯克资讯中心首页 = SpaceX方向），后续标签是该legend的其他工作方向。每个工作方向标签页聚合该方向的完整Front生态：核心公司、全世界相关实体、供应链、融资、政策、评论。

## 用户场景与测试 *(mandatory)*

### 用户故事 1 - Legend排行榜浏览 (Priority: P1)

用户可以通过Legend排行榜（应用首页）浏览所有奇点（Legend）实体。排行榜采用左右结构：左侧显示按关注度排序的legend列表，右侧显示近一周各legend的相关新闻。排行榜会随新闻推送实时变化，将24小时内在舆情风口浪尖的legend推到前三位。

**为什么这个优先级**: 这是整个应用的首页和入口点，用户首先看到的是舆情热度最高的legend。没有这个功能，用户无法发现和进入具体的legend详情。

**独立测试**: 可以完全测试该功能，用户能够：查看左右分栏的排行榜、看到左侧按热度排序的legend列表、看到右侧对应的相关新闻、点击legend进入详情页面。

**验收场景**:

1. **Given** 用户打开Singularity Front应用，**When** 页面加载完成，**Then** 用户看到Legend排行榜（左右分栏布局），左侧显示所有 Legend 和 Supernova 实体按关注度排序，右侧显示近一周相关新闻
2. **Given** 用户浏览排行榜，**When** 查看左侧任意实体卡片，**Then** 卡片显示实体logo、名称、等级（SINGULARITY/SUPERNOVA）、最新工作方向、实时排名
3. **Given** 用户浏览排行榜，**When** 查看右侧新闻区域，**Then** 看到近一周内各legend的相关新闻列表（按时间倒序）
4. **Given** 用户在排行榜左侧列表，**When** 点击任意实体卡片，**Then** 跳转到"Legend资讯中心"页面
5. **Given** 新闻数据更新，**When** 排行榜刷新，**Then** 前三名为24小时内舆情风口浪尖的legend，排名实时变化

---

### 用户故事 2 - Legend资讯中心 (Priority: P1)

用户从Legend排行榜点击某个legend实体后，进入"Legend资讯中心"页面。资讯中心采用标签页结构，每个标签页代表该legend的一个工作方向。第一个标签是"近期新闻驱动"（动态变化），后续标签是该legend的其他固定工作方向。每个工作方向标签页聚合该方向的完整Front生态信息：核心公司、全世界相关实体、供应链、融资、政策、评论，让用户一眼看到该legend如何在这个方向推动文明变化。

**为什么这个优先级**: 这是系统的核心价值所在，是用户的工作中心面板。用户需要快速理解"这个legend在XX方向推动什么变化"、"涉及哪些关键实体"、"整个Front的构成"，没有这个功能，系统就无法体现"奇点是驱动力，Front是冲击波"的核心理念。

**独立测试**: 可以完全测试该功能，用户能够：从排行榜点击进入资讯中心、查看不同工作方向的标签页、在每个标签页看到完整的Front生态、理解该legend如何推动文明变化。

**验收场景**:

1. **Given** 用户在Legend排行榜，**When** 点击某个实体（如马斯克），**Then** 跳转到"Legend资讯中心"页面，显示多个标签页（每个标签 = 一个工作方向）
2. **Given** 用户在资讯中心，**When** 查看第一个标签（近期新闻驱动），**Then** 看到今天新闻相关的工作方向（如SpaceX申报卫星 → 显示SpaceX标签页内容）
3. **Given** 用户在资讯中心，**When** 浏览任意工作方向标签页（如SpaceX），**Then** 看到该方向的完整Front生态：SpaceX公司信息、全球卫星基建相关实体、供应链企业、政策影响、世界评论、融资情况
4. **Given** 用户在资讯中心，**When** 切换到其他工作方向标签（如Tesla），**Then** 看到Tesla方向的完整Front生态（特斯拉公司、电动车供应链、电池技术相关实体等）
5. **Given** 用户在任意工作方向标签页，**When** 点击某个供应链企业，**Then** 打开该企业的Front信息面板（新页面）

---

### 用户故事 3 - Front企业信息面板 (Priority: P2)

用户从Legend资讯中心点击供应链企业后，可以查看该企业的详细信息，包括基本情况、关键领导人、最新动态、估值、股价表现等，理解该企业在legend推动的文明变化中的角色。

**为什么这个优先级**: 这是Legend资讯中心的自然延伸，帮助用户理解Front的构成。优先级为P2是因为它依赖于用户故事2的实现，提供更深层次的信息。

**独立测试**: 可以完全测试该功能，用户能够：从Legend资讯中心点击进入企业详情、查看企业完整信息、返回Legend资讯中心。

**验收场景**:

1. **Given** 用户在Legend资讯中心（如黄仁勋），**When** 点击供应链企业（如台积电），**Then** 打开台积电的Front企业信息面板
2. **Given** 用户查看企业信息面板，**When** 浏览"基本情况"部分，**Then** 看到公司名称、成立时间、总部地点、主营业务、员工规模
3. **Given** 用户查看企业信息面板，**When** 浏览"关键人物"部分，**Then** 看到CEO、CTO等核心领导人的姓名和简介
4. **Given** 用户查看企业信息面板，**When** 浏览"最新动态"部分，**Then** 看到近期公司大事件（如财报发布、重大合作、产品发布）
5. **Given** 用户查看企业信息面板，**When** 浏览"估值/股价"部分，**Then** 看到最新估值（上市前）或股价图表（上市公司）
6. **Given** 用户在企业信息面板，**When** 点击返回按钮，**Then** 返回到Legend资讯中心

---

### 用户故事 4 - 奇点旗下公司/事业部详情 (Priority: P2)

用户在Legend资讯中心中可以看到该legend旗下或关联的公司/事业部（奇点前沿主体），点击可查看详细信息，包括公司基本情况、关键人物、最新产品动态、融资情况、估值情况。

**为什么这个优先级**: 这帮助用户理解legend的实体载体。优先级为P2是因为它补充了用户故事2的信息，提供更完整的legend生态视图。

**独立测试**: 可以完全测试该功能，用户能够：在资讯中心看到旗下公司列表、点击查看公司详情、返回资讯中心。

**验收场景**:

1. **Given** 用户查看Legend资讯中心（如马斯克），**When** 浏览"旗下公司"部分，**Then** 看到相关公司列表（如Tesla、SpaceX、xAI）
2. **Given** 用户在资讯中心，**When** 点击某个公司（如SpaceX），**Then** 打开该公司的详细信息面板
3. **Given** 用户查看公司详情，**When** 浏览各个部分，**Then** 看到公司基本情况、关键人物、最新产品动态、最新融资情况、最新估值情况
4. **Given** 用户在公司详情页，**When** 点击返回，**Then** 返回到Legend资讯中心

---

### 用户故事 5 - 历史档案与核心人物档案查看 (Priority: P3)

用户在Legend资讯中心中可以找到历史档案和核心人物档案的入口，点击可查看完整的档案信息。这些信息不是展示重点，但应该可访问。

**为什么这个优先级**: 这些档案提供背景信息，但不是用户的主要关注点。优先级为P3是因为它补充而非核心功能。

**独立测试**: 可以完全测试该功能，用户能够：找到档案入口、点击查看档案、浏览完整档案内容。

**验收场景**:

1. **Given** 用户在Legend资讯中心，**When** 查找"历史档案"部分，**Then** 看到一个可点击的入口（不是完整展示，只是一个链接/按钮）
2. **Given** 用户在资讯中心，**When** 点击"历史档案"入口，**Then** 打开该legend的完整历史档案页面
3. **Given** 用户查看历史档案，**When** 浏览内容，**Then** 看到该legend的发展历程、关键节点、重要事件
4. **Given** 用户在资讯中心，**When** 点击"核心人物档案"入口，**Then** 打开核心人物（如legend本人、核心合伙人）的详细档案页面

---

### 边界情况

- 当某个奇点实体缺少logo时，显示默认占位图或首字母缩写
- 当某个奇点缺少"最新工作方向"数据时，显示"暂无数据"提示
- 当供应链企业没有估值数据时（非上市公司），显示"估值未知"或最新融资轮次信息
- 当企业信息面板缺少某些字段时，其他字段正常显示，空字段显示"暂无数据"
- 当用户在资讯中心点击返回时，应该返回到Legend排行榜
- 当新闻数据更新时，系统提供手动刷新按钮，用户点击后重新计算排名和加载最新数据
- 当某个legend在指定时间窗口内没有相关新闻时，新闻数量显示为0，但仍在列表中显示

## 需求 *(mandatory)*

### 功能性需求

**列表与排序需求**:
- **FR-001**: 系统必须显示所有 Legend 和 Supernova 等级的实体，不显示未定级实体
- **FR-002**: 系统必须按关注度从高到低排序实体列表（SINGULARITY在前，SUPERNOVA在后，同等级内按新闻数量排序）
- **FR-002-MVP**: MVP阶段使用简化排名算法：创建新闻统计表，统计每个legend在指定时间窗口（如近一周）的相关新闻数量，按数量降序排列
- **FR-002-FUTURE**: 后续可升级为复杂舆情分析（Google Search数量、Twitter/X粉丝数等），作为优化方向
- **FR-003**: 系统必须在每个实体卡片上显示实体logo、名称（中英文）、等级标签、最新工作方向（一句话摘要）、新闻数量统计

**Legend排行榜布局需求**:
- **FR-LAYOUT-001**: Legend排行榜必须采用左右分栏布局：左侧显示legend列表（按关注度排序），右侧显示近一周相关新闻
- **FR-LAYOUT-002**: 左侧列表必须显示每个legend的实时排名（前三名高亮显示为"舆情风口浪尖"）
- **FR-LAYOUT-003**: 右侧新闻区域必须显示近一周内各legend的相关新闻标题，按时间倒序排列（仅显示标题，不显示正文）
- **FR-LAYOUT-004**: 排行榜作为应用首页，必须在用户打开应用时首先加载

**Legend资讯中心需求**:
- **FR-HUB-001**: Legend资讯中心必须采用标签页结构，每个标签页代表该legend的一个工作方向
- **FR-HUB-002**: 第一个标签页必须是"近期新闻驱动"（动态），根据当天最热门的新闻自动切换到对应工作方向
- **FR-HUB-003**: 后续标签页是该legend的固定工作方向列表（可手动维护）
- **FR-HUB-004**: 每个工作方向标签页必须聚合该方向的完整Front生态信息，包括：
  - 核心公司/实体（该方向的载体）
  - 全世界相关实体（受该方向影响的所有公司、机构）
  - 供应链关系（上游供应商、下游客户）
  - 产品/服务进展
  - 融资情况
  - 国家政策影响
  - 世界评论汇总
- **FR-HUB-005**: 用户可以在资讯中心内切换不同工作方向的标签页，查看该legend在不同方向的Front生态
- **FR-HUB-006**: 从任意工作方向标签页点击相关实体，可以打开该实体的详细信息面板

**旗下公司/事业部需求**:
- **FR-011**: 系统必须在奇点资讯面板中显示"旗下公司/事业部"部分，列出该奇点担任创始人、CEO、董事长的公司或核心事业部
- **FR-012**: 系统必须允许用户点击公司名称打开公司详细信息面板
- **FR-013**: 公司详细信息面板必须显示：公司基本情况、关键人物信息、最新产品动态、最新融资情况、最新估值情况

**Front企业信息面板需求**:
- **FR-014**: 系统必须允许用户从供应链列表或旗下公司列表点击进入企业信息面板
- **FR-015**: 企业信息面板必须显示：公司名称、成立时间、总部地点、主营业务、员工规模、关键领导人、近期大事件、估值情况、股价表现（如适用）
- **FR-016**: 系统必须在企业信息面板中提供返回按钮，返回到奇点资讯面板

**历史档案与核心人物档案需求**:
- **FR-017**: 系统必须在奇点资讯面板中提供"历史档案"和"核心人物档案"的入口（不展开完整内容，只显示入口）
- **FR-018**: 系统必须在用户点击入口时打开完整的档案页面（可以是在当前页面展开或跳转到新页面）
- **FR-019**: 历史档案必须显示该奇点的发展历程、关键节点、重要事件的时间线
- **FR-020**: 核心人物档案必须显示人物的基本信息、职业经历、成就贡献、观点言论

**数据更新与缓存需求**:
- **FR-021**: 系统必须在数据更新时自动刷新列表和面板信息，缓存时间不超过15分钟
- **FR-022**: 系统必须在数据缺失时显示友好的提示信息（如"暂无数据"），而不是空白或错误
- **FR-023**: 系统必须保持用户的浏览状态（如滚动位置、展开/折叠状态）在数据刷新后不丢失

**数据源要求** (Constitution I. 数据可靠性原则):
- **FR-DATA-001**: 系统必须使用手动维护的公司档案模块作为主要数据源
- **FR-DATA-002**: 系统必须允许AI辅助整理数据，但最终数据必须经过人工审核
- **FR-DATA-003**: 系统必须为所有外部数据提供来源追溯，显示数据来源（如"基于XX档案整理"、"来源：XX新闻"）
- **FR-DATA-004**: 系统必须禁止使用未经证实的社交媒体传言或不可靠来源的数据

**模块归属** (Constitution II. 模块独立性原则):
- **FR-MOD-001**: 该功能属于公司档案模块，使用手动维护 + AI辅助整理的数据源
- **FR-MOD-002**: 系统不得混用新闻抓取模块的数据作为档案数据（新闻可以引用，但不能替代档案）
- **FR-MOD-003**: 系统不得混用财报数据模块的数据（财报数据可以引用，但不能替代档案）
- **FR-MOD-004**: 系统预留与关联分析模块的接口，但该模块尚未实现

**奇点哲学要求** (Constitution V. 奇点哲学原则):
- **FR-PHILOS-001**: 系统只显示 SINGULARITY 和 SUPERNOVA 等级的实体，不显示未定级实体
- **FR-PHILOS-002**: 系统必须明确标识每个实体的等级（SINGULARITY = 已开启新时代，SUPERNOVA = 爆发中）
- **FR-PHILOS-003**: 系统必须在资讯面板的描述中体现该奇点如何推动"文明级影响"
- **FR-PHILOS-004**: 档案记录必须客观、中立，避免主观评价

### 关键实体

**Legend（奇点实体）**:
- **legend_id**: 唯一标识符（如 `musk`, `huang`, `altman`）
- **legend_type**: 实体类型（PERSON = 人物，ORGANIZATION = 组织）
- **legend_level**: 实体等级（SINGULARITY = 奇点，SUPERNOVA = 超新星）
- **name_zh**: 中文名称
- **name_en**: 英文名称
- **logo_url**: 实体logo图片URL
- **focus_area**: 最新工作方向（一句话摘要）
- **news_count**: 相关新闻数量（用于排名，基于新闻统计表）
- **rank_position**: 当前排名位置

**NewsCountStats（新闻统计表）**:
- **legend_id**: 相关奇点实体
- **time_window**: 统计时间窗口（如"近一周"、"近24小时"）
- **news_count**: 新闻数量
- **news_titles**: 新闻标题列表（仅保留标题，不保留正文）
- **last_updated**: 最后更新时间
- **rank_position**: 在该时间窗口内的排名位置
- **retention_policy**: 数据保留策略（3年，暂不自动清理）

**WorkDirection（工作方向）**:
- **direction_id**: 方向唯一标识符
- **legend_id**: 所属奇点实体
- **direction_name**: 方向名称（如"GPU芯片"、"太空殖民"、"电动车"）
- **is_primary**: 是否为该legend的主要方向
- **tab_order**: 在资讯中心的标签页顺序（1 = 首页/新闻驱动，2,3,4... = 固定方向）
- **core_entity**: 核心公司/实体（该方向的载体，如SpaceX、Tesla）
- **related_entities**: 全世界相关实体列表（受该方向影响的公司、机构、项目）
- **supply_chain**: 供应链关系（供应商、客户、合作伙伴）
- **product_progress**: 产品/服务进展描述
- **funding_info**: 融资情况
- **policy_impact**: 国家政策影响列表
- **world_comments**: 世界评论汇总
- **news_keywords**: 该方向的关键词（用于新闻匹配）
- **last_news_driven**: 最近一次作为首页驱动的新闻时间

**Company（公司/供应链企业）**:
- **company_id**: 公司唯一标识符（如 `tsmc`, `nvidia`）
- **name_zh**: 公司中文名称
- **name_en**: 公司英文名称
- **logo_url**: 公司logo图片URL
- **founded_year**: 成立年份
- **headquarters**: 成立时间
- **main_business**: 主营业务描述
- **employee_count**: 员工规模
- **latest_valuation**: 最新估值（数字+货币单位）
- **stock_ticker**: 股票代码（如适用）
- **key_people**: 关键领导人列表（CEO, CTO等）
- **recent_events**: 近期大事件列表

**SupplyChainRelationship（供应链关系）**:
- **legend_id**: 奇点实体
- **company_id**: 供应链企业
- **relationship_type**: 关系类型（供应商、客户、合作伙伴、竞争对手）
- **importance**: 重要性评分（高/中/低）

**FundingInfo（融资信息）**:
- **entity_id**: 实体ID（可以是legend_id或company_id）
- **funding_round**: 融资轮次（如A轮、B轮、IPO）
- **amount**: 融资金额
- **date**: 融资日期
- **investors**: 投资方列表
- **valuation_after**: 融资后估值

**PolicyInfo（政策信息）**:
- **policy_id**: 政策唯一标识符
- **legend_id**: 相关奇点实体
- **policy_name**: 政策文件名称
- **publishing_org**: 发布机构
- **publish_date**: 发布日期
- **summary**: 核心内容摘要
- **impact_analysis**: 对该奇点的影响分析

**WorldComment（世界评论）**:
- **comment_id**: 评论唯一标识符
- **legend_id**: 相关奇点实体
- **source**: 评论来源（媒体/专家）
- **author**: 作者/机构名称
- **publish_date**: 发布日期
- **core_viewpoint**: 核心观点
- **original_url**: 原文链接

**HistoricalArchive（历史档案）**:
- **legend_id**: 奇点实体
- **timeline_events**: 时间线事件列表（每个事件包含日期、事件描述、影响分析）

**CorePersonProfile（核心人物档案）**:
- **person_id**: 人物唯一标识符
- **legend_id**: 相关奇点实体
- **basic_info**: 基本信息（出生日期、国籍、教育背景）
- **career_history**: 职业经历
- **achievements**: 成就贡献
- **quotes**: 观点言论列表

## 成功标准 *(mandatory)*

### 可衡量的结果

- **SC-001**: 用户可以在 3 秒内加载奇点实体列表页面（包含所有实体卡片）
- **SC-002**: 用户可以在 2 次点击内从列表页进入任意奇点的全面资讯面板
- **SC-003**: 用户可以在资讯面板中一眼看到该奇点的所有关键信息（工作方向、供应链、政策、评论），无需滚动超过 2 屏
- **SC-004**: 用户可以在 3 次点击内从奇点资讯面板跳转到任意供应链企业的详细信息
- **SC-005**: 系统可以支持至少 50 个奇点实体和 500 个供应链企业的数据展示
- **SC-006**: 数据更新后，用户可以在 15 分钟内看到最新的信息（自动刷新或手动刷新）
- **SC-007**: 90% 的用户能够第一次使用时就理解如何浏览奇点列表、查看资讯面板、查看企业详情（无需帮助文档）
- **SC-008**: 系统在缺少某些数据时仍能正常展示其他信息，不会出现页面崩溃或空白（数据容错率 100%）

## 假设与约束

**假设与约束**

### 假设

- 用户对奇点和超新星的概念有基本了解（通过简短的引导/说明可以补充）
- 用户使用现代浏览器（Chrome, Firefox, Safari, Edge 的最新版本）
- 用户设备屏幕宽度 >= 1024px（桌面端优先，移动端响应式适配为后续需求）
- 数据由管理员手动维护，用户不需要编辑或提交数据
- 每个奇点实体至少包含基本信息（名称、logo、等级、工作方向），其他字段可选
- **MVP阶段假设**: 使用简化的新闻数量统计作为排名算法，后续可升级为复杂舆情分析
- **更新机制假设**: MVP阶段使用手动刷新，后续可优化为定时自动刷新（需遵守15分钟最小间隔原则）
- **新闻数据假设**: 仅保留新闻标题（不保留正文），新闻来源于新闻抓取模块的关键词过滤结果
- **资讯中心架构假设**: 每个legend有多个工作方向，每个工作方向是一个标签页，第一个标签页根据近期新闻动态切换

### 约束

- 技术栈必须遵循 Singularity Front 的技术约束：Python 3.11+, FastAPI, 原生 HTML/CSS/JS
- 数据更新频率不能低于 15 分钟间隔（Constitution III. 最小侵入原则）
- 所有用户界面内容必须使用简体中文（Constitution IV. 中文优先原则）
- 数据源必须来自可靠的手动维护档案，禁止使用不可靠来源（Constitution I. 数据可靠性原则）
- 系统不得混用不同模块的数据源（Constitution II. 模块独立性原则）
- 新闻数据仅保留标题（不保留正文），保存时间3年，暂不实现自动清理功能
- 舆情数据（如Google Search、Twitter/X粉丝数）仅用于计算关注度评分，不得替代档案内容，必须明确标注数据来源和更新时间
